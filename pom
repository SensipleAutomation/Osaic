package webpages;

import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.DataFlavor;
import java.awt.datatransfer.UnsupportedFlavorException;
import java.io.IOException;

import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.FindBy;
import org.openqa.selenium.support.PageFactory;

import datadriven.hashdatafromexcel;

public class clientpage {
	
	WebDriver driver;
	
	

	@FindBy(xpath="//div[@class='banner-text']//h2")
	public WebElement Clientname;
	@FindBy(xpath="//ul[@role='tablist']/li[2]/a/span")
	public WebElement Account_tab;
	@FindBy(xpath="//tbody/tr[1]/td[2]/a")
	public WebElement FirstAccountNumber;
	@FindBy(xpath="//span[@class='client-header ng-star-inserted']")
	//@FindBy(className="client-header ng-star-inserted")
	public WebElement Clientpage_Title;
	@FindBy(xpath="//web-button[@name='save']//button/span")
	public WebElement Saveandcontinue_Button;
	@FindBy(xpath="//web-employment-information//h3//span[contains(@class,'web-green')]")
	public WebElement Empinfo_greenicon;
	@FindBy(xpath="//web-other-profile-details//h3//span[contains(@class,'web-green')]")
	public WebElement otherdetails_greenicon;
	@FindBy(xpath="//h4[contains(text(),'Success')]")
	public WebElement Success_banner;
	@FindBy(xpath="//button[@label='DISMISS']")
	public WebElement dismiss_Button;
	
	public clientpage(WebDriver driver)
	{
		this.driver=driver;
		PageFactory.initElements(driver, this);
	}
	//select the accordion by providing title of the accordion eg:'Other Profile Details','Employment Information'
	public  WebElement selectaccordion(String Accordiontitle) {
		WebElement clientaccordion =driver.findElement(By.xpath("//span[@class='heading'][contains(text(),'"+Accordiontitle+"')]"));
	return clientaccordion;
	}
	
	//This method will select the specific dropdown and select the values in the dropdown list
	//Parameter 1- dropdownname is the name of the dropdown from html page
	//parameter2-empstatus is the name of the dropdown from html page
	public void selectdropdown(String dropdownname,String dropdownvalue) throws InterruptedException
	{
		dropdownpath(dropdownname).click();
		Thread.sleep(500);
		driver.findElement(By.xpath("//p-dropdownitem/li[@aria-label='"+dropdownvalue+"']")).click();
	}
	
	//This method will auto generate the xpath for all the dropdown fileds
	public WebElement dropdownpath(String dropdownname)
	{
		return driver.findElement(By.xpath("//web-field[@name='"+dropdownname+"']//web-select//div[1]/span"));	
	}

	//This method will auto generate the xpath for all the text fileds
	public WebElement textfieldpath(String fieldtitlename)
	{
		return driver.findElement(By.xpath("//web-field[@name='"+fieldtitlename+"']//web-text//input"));	
	}
	//This method is used to select the text field erase old data  and provide the data	
	//parameter "fieldtitlename" should be the name of the field that need to be selected
	//parameter excelfield is the data from excel sheet
	public void edittextfield(String fieldtitlename,String excelfield) throws InterruptedException {
		textfieldpath(fieldtitlename).click();
		textfieldpath(fieldtitlename).sendKeys(Keys.chord(Keys.CONTROL,"a",Keys.DELETE));
		textfieldpath(fieldtitlename).sendKeys(hashdatafromexcel.hmap.get(excelfield));
	Thread.sleep(1000);
	}
	
	//This method will copy the text value of text filed and validate that with excel data
	public void validatetext(String fieldtitlename) throws UnsupportedFlavorException, IOException
	{
		textfieldpath(fieldtitlename).click();
		textfieldpath(fieldtitlename).sendKeys(Keys.chord(Keys.CONTROL,"a"));
		textfieldpath(fieldtitlename).sendKeys(Keys.chord(Keys.CONTROL,"c"));
		Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();
		Object data=clipboard.getData(DataFlavor.stringFlavor);
		String fieldvalue= (String) data;
		if(fieldtitlename=="zipCode")
		{
		String zipcode5=fieldvalue.substring(0, 4);
		
		fieldvalue=zipcode5;
		}
		System.out.println(hashdatafromexcel.hmap.containsValue(fieldvalue));
		System.out.println(fieldvalue);
	}

	


}
